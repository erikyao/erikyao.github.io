---
layout: post
title: "R Metaprogramming"
description: "Digest of Part IV, in-progress 2nd Edition of <i>Advanced R</i>"
category: 
tags: []
---
{% include JB/setup %}

P.S. 2nd Edition of _Advanced R_ is still in-progress. May update in the future.

# [Part IV - Metaprogramming](https://adv-r.hadley.nz/meta.html)

我觉得这部分主要解决的一个大问题就是：有引号和没引号的区别？比如：

- 为何 `library(purrr)` 和 `library("purrr")` 都可以？
- 为何 `plot(x, y)` 它知道 x-label 是 string `"x"`, y-label 是 string `"y"`?
- 为何 `dplyr:select(df, x)` 的 `x` 不用写引号？ 你这里 `x` 又不是 variable

然后 Non-Standard Evalution (NSE) 这个词有点 misleading。它的 non-standard 并不是说它 evaluation 的**结果**, 并不是说 standard 是 evaluate 成 5 你 non-standard 就 evaluate 成 6，而是指 evaluation 的**场合**：你自己手动去 evaluate 的，不是 interpreter 自己去 evaluate 的，那就是 non-standard evaluation。

Big ideas: (回头筛选；画图)

* Code is data; captured code is called an expression.
* Code has a tree-like structure called an abstract syntax tree.
* Expressions can be generated by code.
* Evaluation executes an expression in an environment.
* Evaluation can be customised by modifying or overriding the environment.
* Data masks blur environments and data frames.
* A quosure captures an expression with its environment.

base::quote()
base::bquote()
base::enquote()
base::substitute()

rlang::expr()
rlang::enexpr()

dplyr::expr()
dplyr::enexpr()
dplyr::quo()
dplyr::enquo()


   


---
layout: post
title: "R functions used in practice"
description: ""
category: R
tags: [R-101]
---
{% include JB/setup %}

## 4. 排序与遍历

### unique: 排除重复元素

<pre class="prettyprint linenums">
&gt; x &lt;- c(1:5, 2:6)
&gt; unique(x)
[1] 1 2 3 4 5 6
</pre>

### which.min: 找到 min 值所在的 index 或者行号；同理有 which.max

<pre class="prettyprint linenums">
&gt; x &lt;- c(7:9, 4:6, 1:3)
&gt; x
[1] 7 8 9 4 5 6 1 2 3
&gt; which.min(x)
[1] 7
&gt; which.max(x)
[1] 3
</pre>

-----

## 6. subset

`data(airquality)` 之后（BTW，`data()` 可以查看所有内置的 dataset）：

<pre class="prettyprint linenums">
&gt; subset(airquality, Month == 8 & Temp &gt; 90)
## 等同于
&gt; airquality[airquality$Month == 8 & airquality$Temp &gt; 90, ]
</pre>

而且 [In R, why is \[ better than `subset`?](http://stackoverflow.com/questions/9860090/in-r-why-is-better-than-subset) 说 [] 确实是要比 subset 好，具体细看。  

注意下这个逻辑，虽然 `airquality$Month` 是 column，但是 `airquality$Month == 8` 得到是一个长度为 nrow 的、值为 TRUE/FALSE 的 vector，`airquality[]` 根据这个 vector 过滤出值为 TRUE 的 row，所以 `airquality$Month == 8` 要放在 `[row,]` 的位置上。

-----

## 7. NA 的处理

### na.omit: 去掉有 NA 的行

<pre class="prettyprint linenums">
&gt; DF &lt;- data.frame(x = c(1, 2, 3), y = c(0, 10, NA))
&gt; na.omit(DF)
  x  y
1 1  0
2 2 10
</pre>

但是要注意，`na.omit(DF)` 并没有改变 DF 的值，要想改变 DF 的值，需要重新赋值 `DF <- na.omit(DF)`。

### read.table 的 na.strings 参数

na.strings: a character vector of strings which are to be interpreted as NA values.   

比如有的 table 里是 "N/A" 或 "Not Available"，那么就可以设置成 `read.table(..., na.strings=c("N/A", "Not Available" ),...)`。  

### data.frame 的 stringsAsFactors 参数（read.table 也有）

默认是 TRUE，此时元素是字符串的列 `df$A` 会被当做 factor，`df$A[[1]]` 会被当成 factor 的一个元素，`str(df$A[[1]])` 会得到类似 `Factor w/ 4510 levels "ABBEVILLE AREA MEDICAL CENTER",..: 866` 这样的信息，表示 `str(df$A[[1]])` 是 4510 个 levels 中 level 为 866 的元素，而且 `return(df$A[[1]])` 也会打出 `4510 Levels: ABBEVILLE AREA MEDICAL CENTER ...` 这样的信息，略烦。如果不用 factor 相关的功能，可以把 stringsAsFactors 这一项设置为 FALSE。  

关闭之后，`str(df$A)` 得到的是类似 `chr [1:370] "PROVIDENCE MEMORIAL HOSPITAL" ...` 这样的信息，表示是一个 string vector；`str(df$A[[1]])` 得到的是 `chr "CYPRESS FAIRBANKS MEDICAL CENTER"`。  

注意 `read.table` 也有 stringsAsFactors，功能一样。你 `read.table` 后再 `data.frame` 或者 `subset` 抽取的话，得到的 factor 可能是 `read.table` 时就分配好的，可能出现 levels 大于 length(df) 的情况。

-----

## 8. 其他

### read.table 的 comment.char 参数

有些文件一开头是注释，比如有像这样用 ## 开头的：

	## This file is generated by ...
	## Coworkers are ...
	id,xxx,yyy,zzz
	1,x1,y1,z1
	2,x2,y2,z2
	
这时我们就可以用 `comment.char="##"` 来跳过这些 comments
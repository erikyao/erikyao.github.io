
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Erik Yao's initializer</title>
    <meta name="description" content="">
    <meta name="author" content="Erik Yao">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/css/1.4.0/bootstrap.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  
    <link rel="shortcut icon" href="/favicon.ico">
  <!-- Update these with your own images
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
	<link href="/assets/themes/twitter/google-code-prettify/prettify.css" rel="stylesheet" type="text/css" media="all">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/themes/twitter/google-code-prettify/prettify.js"></script>
	<script type="text/javascript" src="/assets/themes/twitter/google-code-prettify/use-prettify.js"></script>
  </head>

  <body>

    <div class="topbar">
      <div class="fill">
        <div class="container">
          <a class="brand" href="/">Erik Yao's</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/index.html">Home</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>initializer <small></small></h1>
</div>

<div class="row">
  <div class="span10">
    <p>　　A block-formed initializer can be appended after the fields declared.</p>

<p>　　If the fields are static, the initializer can also be static too, which means it's only executed once. If the initializer is not static, it will be executed as many times as the class constructor will be, even if the fields are static.</p>

<p>　　The non-static fields can not be initialized in a static intializer.</p>

<pre class="prettyprint linenums">
class Book {     
    Book(int id) {     
        System.out.println("This is book No." + id);     
    }     
}     
    
class Bookshelf {     
    // case 1:     
    /**   
    Book b1;   
    Book b2;    
    {   
        b1 = new Book(1);   
        b2 = new Book(2);   
    }   
    */    
    //output:     
    //This is book No.1     
    //This is book No.2     
    //This is book No.1     
    //This is book No.2     
    
    //case 2:     
    static Book b1;     
    static Book b2;     
    static      
    {     
        b1 = new Book(1);     
        b2 = new Book(2);     
    }     
    //output:     
    //This is book No.1     
    //This is book No.2     
    
    //case 3:     
    /**   
    static Book b1;   
    static Book b2;   
    {   
        b1 = new Book(1);   
        b2 = new Book(2);   
    }   
    */    
    //output:     
    //This is book No.1     
    //This is book No.2     
    //This is book No.1     
    //This is book No.2     
    
    //case 4:     
    /**   
    Book b1;   
    Book b2;   
    static    
    {   
        b1 = new Book(1);   
        b2 = new Book(2);   
    }   
    */    
    //output: error     
}     
    
class InitBlockTest {     
    public static void main(String[] arg) {     
        new Bookshelf();     
        new Bookshelf();     
    }     
}
</pre>


<p><em>9月4号补充:</em></p>

<p>　　initializer 不一定非要是初始化成员，在 initializer 内部其实是可以随便写的，像这样也可以：</p>

<pre class="prettyprint linenums">
class Test {  
    //static  
    {  
        System.out.println("pass");  
    }  
}  
  
public class InitializerTest {  
    public static void main(String[] args) {  
        new Test();  
        new Test();  
    }  
}  
  
//output  
/* 
    pass 
    pass 
*/ 
</pre>


<p>　　另：在声明 field 的时候，常常会当场初始化 field，这个称为 variable intializer (更倾向于将声明 field 的表达式右值称为 variable initializer)。根据 field 是否 static 及初始化是否调用了 static 方法，variable initializer 有的属于 class 行为，有的属于 object 行为。static initializer 完全属于 class 行为。</p>

<p><br/></p>

<p><em>2009年09月04日归纳</em>：<a href="/java/2009/09/04/class-loading-further-discussion-involving-steps-of-instance-creation/">class loading: further discussion involving steps of instance creation</a></p>

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/java/2009/03/19/accessibility-of-class-and-class-member" title="关于 class 和 class member 的访问权限">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/java/2009/03/23/overload-and-override" title="overload and override: 重载与覆写">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    
  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>19 March 2009</span></div>
	
  <br/>
	
  
    <h4>Categories</h4>
	<ul class="tag_box">
	
	


  
     
    	<li><a href="/categories.html#java-ref">
    		java <span>40</span>
    	</a></li>
    
  


	</ul>
    

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#Java-101-ref">Java-101 <span>49</span></a></li>
    
  



    </ul>
    
  </div>
</div>


      </div>

      <footer>
        <p>&copy; Erik Yao 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div> <!-- /container -->

    
  </body>
</html>

